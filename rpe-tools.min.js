var RPETools=function(){function get(a){buf="",line="";try{var b=new java.io.BufferedReader(new java.io.InputStreamReader((new java.net.URL(a)).openConnection().getInputStream()));while((line=b.readLine())!=null){buf+=line}b.close()}catch(c){java.lang.System.out.println("RPETools.js Exception: "+c)}return buf}function uid(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function getFile(a){var b=new java.io.File(a);if(!b.exists()){b.createNewFile()}return b}function writeToFile(){var a=arguments[0]?arguments[0]:"";var b=arguments[1]?arguments[1]:"";var c=arguments[2]?arguments[2]:false;var d=getFile(a);var e=new java.io.FileWriter(d,c);var f=new java.io.BufferedWriter(e);f.write(b);f.close()}function setHost(){host=arguments[0]?arguments[0]:"localhost";port=arguments[1]?arguments[1]:27465;serviceURI="http://"+host+":"+port+"/"}function quit(){request=serviceURI+"/quit";get(request);java.lang.System.out.println("RPETools.js: quit RPE Persistence Server.");return""}var JSON;if(!JSON){JSON={}}(function(){function f(a){return a<10?"0"+a:a}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];if(i&&typeof i==="object"&&typeof i.toJSON==="function"){i=i.toJSON(a)}if(typeof rep==="function"){i=rep.call(b,a,i)}switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i){return"null"}gap+=indent;h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1){h[c]=str(c,i)||"null"}e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]";gap=g;return e}if(rep&&typeof rep==="object"){f=rep.length;for(c=0;c<f;c+=1){if(typeof rep[c]==="string"){d=rep[c];e=str(d,i);if(e){h.push(quote(d)+(gap?": ":":")+e)}}}}else{for(d in i){if(Object.prototype.hasOwnProperty.call(i,d)){e=str(d,i);if(e){h.push(quote(d)+(gap?": ":":")+e)}}}}e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}";gap=g;return e}}"use strict";if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","    ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;if(typeof JSON.stringify!=="function"){JSON.stringify=function(a,b,c){var d;gap="";indent="";if(typeof c==="number"){for(d=0;d<c;d+=1){indent+=" "}}else if(typeof c==="string"){indent=c}rep=b;if(b&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":a})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e==="object"){for(c in e){if(Object.prototype.hasOwnProperty.call(e,c)){d=walk(e,c);if(d!==undefined){e[c]=d}else{delete e[c]}}}}return reviver.call(a,b,e)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();var host="localhost";var port=27465;var serviceURI="http://"+host+":"+port+"/";var Storage=function(){function a(){var a=arguments[0]?arguments[0]:"";var b="";if(a!=""){request=serviceURI+"storage/read?name="+encodeURIComponent(a);try{b=JSON.parse(decodeURIComponent(get(request)));java.lang.System.out.println("RPETools.js: read variable '"+a+"' from Storage.")}catch(c){java.lang.System.out.println("RPETools.js Exception: Requested variable not found on server, or is corrupted. Empty string returned.")}}else{throw new Error("RPETools.js Exception: RPETools.Storage.read(): First argument (name) was missing.")}return b}function b(){var a=arguments[0]?arguments[0]:"";var b=arguments[1]?arguments[1]:"";var c="";if(a!=""){request=serviceURI+"storage/write?name="+encodeURIComponent(a)+"&value="+encodeURIComponent(JSON.stringify(b));get(request);java.lang.System.out.println("RPETools.js: write variable '"+a+"' to Storage.");c=b}else{throw new Error("RPETools.js Exception: RPETools.Storage.write(): First argument (name) was missing.")}return c}function c(){request=serviceURI+"storage/reset";get(request);java.lang.System.out.println("RPETools.js: reset Storage.");return""}function d(){var a=arguments[0]?arguments[0]:"";request=serviceURI+"storage/view";var b="";b=get(request);try{writeToFile(a,b);java.lang.System.out.println("RPETools.js: write Storage XML to file '"+a+"'.")}catch(c){java.lang.System.out.println("RPETools.js Exception: "+c)}return b}return{read:a,write:b,reset:c,saveXML:d}}();var Logger=function(){function a(){var a=arguments[0]?arguments[0]:"";var b=arguments[1]?arguments[1]:"";var c="";if(a!=""){request=serviceURI+"logger/log?uid="+uid()+"&msg="+encodeURIComponent(a);if(b!=""){request+="&tag="+encodeURIComponent(b)}c=decodeURIComponent(get(request));java.lang.System.out.println("RPETools.js: log message with ID '"+c+"' saved to Logger.")}else{throw new Error("RPETools.js Exception: RPETools.Logger.log(): First argument (message) was missing.")}return c}function b(){request=serviceURI+"logger/reset";get(request);java.lang.System.out.println("RPETools.js: reset Logger.");return""}function c(){var a=arguments[0]?arguments[0]:"";request=serviceURI+"logger/view";var b="";b=get(request);try{writeToFile(a,b);java.lang.System.out.println("RPETools.js: write Logger XML to file '"+a+"'.")}catch(c){java.lang.System.out.println("RPETools.js Exception: "+c)}return b}return{log:a,reset:b,saveXML:c}}();return{Storage:Storage,Logger:Logger,setHost:setHost,quit:quit}}();﻿
/**
 * RPE Tools JS
 * Data persistence & logging utility for IBM Rational® Publishing Engine™.
 * Use in conjunction with RPE Persistence Server from Reportable Systems.
 *
 * Copyright 2012, ReportableSystems.com
 * https://github.com/reportablesystems/rpe-tools
 *
 * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
 **/
